package com.amazon.ion.benchmark;


import java.util.List;
import java.util.Map;

/**
 * Decide which data generating method should be executed based on the specifications in the HashMap.
 */
public class GeneratorOptions {

    /**
     * Call the relevant methods which can generate scalar type of Ion data based on the input hashmap.
     * @param optionsMap is the hash map which generated by the command line parser which match the option name and its value appropriately.
     * @throws Exception if errors occurs when calling the methods of generating Ion data.
     */
    public static void executeGenerator(Map<String, Object> optionsMap) throws Exception {
        int size = Integer.parseInt(optionsMap.get("--data-size").toString());
        String format = ((List<String>) optionsMap.get("--format")).get(0);
        String path = optionsMap.get("<output_file>").toString();
        String inputFilePath = optionsMap.get("--input-ion-schema").toString();
        // Check whether the input schema file is valid.
        IonSchemaUtilities.checkValidationOfSchema(inputFilePath);
        ReadGeneralConstraints.readIonSchemaAndGenerate(size, inputFilePath, format, path);
    }
}
